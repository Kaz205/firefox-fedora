#!/usr/bin/bash
# Analyze and print specialized (basic/webrender) test results

TEST_DIR=$1

echo "Mochitest:"
echo -n "PASSED: "
grep "TEST_END: Test OK" $TEST_DIR/mochitest | wc -l
echo -n "FAILED: "
grep "TEST_END: Test ERROR" $TEST_DIR/mochitest | wc -l
echo -n "UNEXPECTED-FAILURES: "
grep "TEST-UNEXPECTED-FAIL" $TEST_DIR/mochitest | wc  -l
echo " "

echo "JS Test Browser:"
grep --text "REFTEST INFO | Successful:" $TEST_DIR/jstestbrowser
grep --text "REFTEST INFO | Unexpected:" $TEST_DIR/jstestbrowser
grep --text "REFTEST INFO | Known problems:" $TEST_DIR/jstestbrowser
echo " "

echo "Marionette:"
grep --text "Expected results:" $TEST_DIR/marionette
grep --text "Skipped:" $TEST_DIR/marionette
grep --text "Unexpected results:" $TEST_DIR/marionette
echo " "

echo "XPCShell:"
grep --text "INFO INFO | Passed:" $TEST_DIR/xpcshell
grep --text "INFO INFO | Failed:" $TEST_DIR/xpcshell

echo "Crash test:"
grep "REFTEST INFO | Successful:" $TEST_DIR/crashtest
grep "REFTEST INFO | Unexpected:" $TEST_DIR/crashtest
echo " "

echo "Reftest:"
grep --text "REFTEST INFO | Successful:" $TEST_DIR/reftest
grep --text "REFTEST INFO | Unexpected:" $TEST_DIR/reftest
grep --text "REFTEST INFO | Known problems:" $TEST_DIR/reftest
echo " "

echo "GTest:"
grep "\[  PASSED  \]" $TEST_DIR/gtest
grep "FAILED TESTS" $TEST_DIR/gtest
echo " "
